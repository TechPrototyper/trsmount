   1:				;       *********************************
   2:				;       *                               *
   3:				;       *     THREE-D  TIC-TAC-TOE      *
   4:				;       *                               *
   5:				;       *********************************
   6:				        
   7:     -	6000          	        ORG     6000H
   8:     -	6000          	BOARD   DEFS    41H
   9:				        
  10:     -	6041  00010203	REFTBL  DEFB    00,01,02,03     ;Possible four-in-a-rows
  11:     -	6045  04050607	        DEFB    04,05,06,07
  12:     -	6049  08090A0B	        DEFB    08,09,10,11
  13:     -	604D  0C0D0E0F	        DEFB    12,13,14,15
  14:     -	6051  10111213	        DEFB    16,17,18,19
  15:     -	6055  14151617	        DEFB    20,21,22,23
  16:     -	6059  18191A1B	        DEFB    24,25,26,27
  17:     -	605D  1C1D1E1F	        DEFB    28,29,30,31
  18:     -	6061  20212223	        DEFB    32,33,34,35
  19:     -	6065  24252627	        DEFB    36,37,38,39
  20:     -	6069  28292A2B	        DEFB    40,41,42,43
  21:     -	606D  2C2D2E2F	        DEFB    44,45,46,47
  22:     -	6071  30313233	        DEFB    48,49,50,51
  23:     -	6075  34353637	        DEFB    52,53,54,55
  24:     -	6079  38393A3B	        DEFB    56,57,58,59
  25:     -	607D  3C3D3E3F	        DEFB    60,61,62,63
  26:     -	6081  0004080C	        DEFB    00,04,08,12
  27:     -	6085  0105090D	        DEFB    01,05,09,13
  28:     -	6089  02060A0E	        DEFB    02,06,10,14
  29:     -	608D  03070B0F	        DEFB    03,07,11,15
  30:     -	6091  1014181C	        DEFB    16,20,24,28
  31:     -	6095  1115191D	        DEFB    17,21,25,29
  32:     -	6099  12161A1E	        DEFB    18,22,26,30
  33:     -	609D  13171B1F	        DEFB    19,23,27,31
  34:     -	60A1  2024282C	        DEFB    32,36,40,44
  35:     -	60A5  2125292D	        DEFB    33,37,41,45
  36:     -	60A9  22262A2E	        DEFB    34,38,42,46
  37:     -	60AD  23272B2F	        DEFB    35,39,43,47
  38:     -	60B1  3034383C	        DEFB    48,52,56,60
  39:     -	60B5  3135393D	        DEFB    49,53,57,61
  40:     -	60B9  32363A3E	        DEFB    50,54,58,62
  41:     -	60BD  33373B3F	        DEFB    51,55,59,63
  42:     -	60C1  00102030	        DEFB    00,16,32,48
  43:     -	60C5  01112131	        DEFB    01,17,33,49
  44:     -	60C9  02122232	        DEFB    02,18,34,50
  45:     -	60CD  03132333	        DEFB    03,19,35,51
  46:     -	60D1  04142434	        DEFB    04,20,36,52
  47:     -	60D5  05152535	        DEFB    05,21,37,53
  48:     -	60D9  06162636	        DEFB    06,22,38,54
  49:     -	60DD  07172737	        DEFB    07,23,39,55
  50:     -	60E1  08182838	        DEFB    08,24,40,56
  51:     -	60E5  09192939	        DEFB    09,25,41,57
  52:     -	60E9  0A1A2A3A	        DEFB    10,26,42,58
  53:     -	60ED  0B1B2B3B	        DEFB    11,27,43,59
  54:     -	60F1  0C1C2C3C	        DEFB    12,28,44,60
  55:     -	60F5  0D1D2D3D	        DEFB    13,29,45,61
  56:     -	60F9  0E1E2E3E	        DEFB    14,30,46,62
  57:     -	60FD  0F1F2F3F	        DEFB    15,31,47,63
  58:     -	6101  00050A0F	        DEFB    00,05,10,15
  59:     -	6105  10151A1F	        DEFB    16,21,26,31
  60:     -	6109  20252A2F	        DEFB    32,37,42,47
  61:     -	610D  30353A3F	        DEFB    48,53,58,63
  62:     -	6111  0306090C	        DEFB    03,06,09,12
  63:     -	6115  1316191C	        DEFB    19,22,25,28
  64:     -	6119  2326292C	        DEFB    35,38,41,44
  65:     -	611D  3336393C	        DEFB    51,54,57,60
  66:     -	6121  0F1E2D3C	        DEFB    15,30,45,60
  67:     -	6125  0B1A2938	        DEFB    11,26,41,56
  68:     -	6129  07162534	        DEFB    07,22,37,52
  69:     -	612D  03122130	        DEFB    03,18,33,48
  70:     -	6131  0C1D2E3F	        DEFB    12,29,46,63
  71:     -	6135  08192A3B	        DEFB    08,25,42,59
  72:     -	6139  04152637	        DEFB    04,21,38,55
  73:     -	613D  00112233	        DEFB    00,17,34,51
  74:     -	6141  0F1B2733	        DEFB    15,27,39,51
  75:     -	6145  0E1A2632	        DEFB    14,26,38,50
  76:     -	6149  0D192531	        DEFB    13,25,37,49
  77:     -	614D  0C182430	        DEFB    12,24,36,48
  78:     -	6151  03172B3F	        DEFB    03,23,43,63
  79:     -	6155  02162A3E	        DEFB    02,22,42,62
  80:     -	6159  0115293D	        DEFB    01,21,41,61
  81:     -	615D  0014283C	        DEFB    00,20,40,60
  82:     -	6161  00152A3F	        DEFB    00,21,42,63
  83:     -	6165  0F1A2530	        DEFB    15,26,37,48
  84:     -	6169  0316293C	        DEFB    03,22,41,60
  85:     -	616D  0C192633	        DEFB    12,25,38,51
  86:				        
  87:				;       These are the 3 x 3 graphic "cells"
  88:				        
  89:     -	6171  BF9F8FBF	FIGMAT  DEFB    191,159,143,191,128,128,128,128,128
	              80808080
	              80
  90:     -	617A  8FBFBC80	        DEFB    143,191,188,128,130,191,128,128,191
	              82BF8080
	              BF
  91:     -	6183  BCBF8FBF	        DEFB    188,191,143,191,129,128,191,128,128
	              8180BF80
	              80
  92:     -	618C  8FAFBF80	        DEFB    143,175,191,128,128,191,128,128,128
	              80BF8080
	              80
  93:     -	6195  80808080	        DEFB    128,128,128,128,128,128,128,128,128
	              80808080
	              80
  94:     -	619E  8080BF80	        DEFB    128,128,191,128,170,191,128,170,191
	              AABF80AA
	              BF
  95:     -	61A7  BF8080BF	        DEFB    191,128,128,191,149,128,191,149,128
	              9580BF95
	              80
  96:     -	61B0  80AABF80	        DEFB    128,170,191,128,170,191,128,191,191
	              AABF80BF
	              BF
  97:     -	61B9  BF9580BF	        DEFB    191,149,128,191,149,128,191,191,128
	              9580BFBF
	              80
  98:     -	61C2  80BFBFAA	        DEFB    128,191,191,170,191,191,191,191,191
	              BFBFBFBF
	              BF
  99:     -	61CB  BFBF80BF	        DEFB    191,191,128,191,191,149,191,191,191
	              BF95BFBF
	              BF
 100:     -	61D4  80808068	        DEFB    128,128,128,104,101,128,128,128,128
	              65808080
	              80
 101:     -	61DD  80BFBF80	        DEFB    128,191,191,128,128,191,128,170,149
	              80BF80AA
	              95
 102:     -	61E6  BFBF80BF	        DEFB    191,191,128,191,128,128,170,149,128
	              8080AA95
	              80
 103:     -	61EF  80BF80AA	        DEFB    128,191,128,170,149,128,191,128,128
	              9580BF80
	              80
 104:     -	61F8  80BF8080	        DEFB    128,191,128,128,170,149,128,128,191
	              AA958080
	              BF
 105:     -	6201  8080AA80	        DEFB    128,128,170,128,128,191,128,170,149
	              80BF80AA
	              95
 106:     -	620A  95808080	        DEFB    149,128,128,128,128,128,128,128,128
	              80808080
	              80
 107:     -	6213  8080AA80	        DEFB    128,128,170,128,128,128,128,128,128
	              80808080
	              80
 108:     -	621C  958080BF	        DEFB    149,128,128,191,128,128,170,149,128
	              8080AA95
	              80
 109:     -	6225  80BF8CAA	        DEFB    128,191,140,170,149,108,191,191,128
	              956CBFBF
	              80
 110:     -	622E  8C8C8C74	        DEFB    140,140,140,116,101,114,128,128,128
	              65728080
	              80
 111:     -	6237  8C8C8C6E	        DEFB    140,140,140,110,097,116,128,128,128
	              61748080
	              80
 112:     -	6240  8CBF8065	        DEFB    140,191,128,101,170,149,128,191,191
	              AA9580BF
	              BF
 113:     -	6249  8080A080	        DEFB    128,128,160,128,186,135,168,151,128
	              BA87A897
	              80
 114:     -	6252  BC8F8F80	        DEFB    188,143,143,128,128,128,128,128,128
	              80808080
	              80
 115:     -	625B  8F8FBC80	        DEFB    143,143,188,128,128,128,128,128,128
	              80808080
	              80
 116:     -	6264  9080808B	        DEFB    144,128,128,139,180,191,128,130,175
	              B4BF8082
	              AF
 117:     -	626D  BF80808B	        DEFB    191,128,128,139,188,176,128,128,131
	              BCB08080
	              83
 118:     -	6276  80808080	        DEFB    128,128,128,128,128,128,143,188,180
	              80808FBC
	              B4
 119:     -	627F  80808080	        DEFB    128,128,128,128,128,128,176,128,128
	              8080B080
	              80
 120:     -	6288  80808380	        DEFB    128,128,131,128,128,128,128,128,128
	              80808080
	              80
 121:     -	6291  8B8FBC80	        DEFB    139,143,188,128,128,128,128,128,128
	              80808080
	              80
 122:     -	629A  B0808083	        DEFB    176,128,128,131,143,180,128,128,191
	              8FB48080
	              BF
 123:     -	62A3  BD9080BF	        DEFB    189,144,128,191,139,180,128,128,130
	              8BB48080
	              82
 124:     -	62AC  8080806F	        DEFB    128,128,128,111,117,114,143,188,188
	              75728FBC
	              BC
 125:     -	62B5  80808063	        DEFB    128,128,128,099,101,128,188,188,143
	              6580BCBC
	              8F
 126:     -	62BE  80BA85B8	        DEFB    128,186,133,184,151,128,129,128,128
	              97808180
	              80
 127:     -	62C7  3730344C	        DEFB    055,048,052,076,097,110,128,128,128
	              616E8080
	              80
 128:     -	62D0  20804E73	        DEFB    032,128,078,115,105,110,128,128,128
	              696E8080
	              80
 129:     -	62D9  20506567	        DEFB    032,080,101,103,044,128,128,052,056
	              2C808034
	              38
 130:     -	62E2  6E6E2E4D	        DEFB    110,110,046,077,073,046,057,048,054
	              492E3930
	              36
 131:     -	62EB  80808035	        DEFB    128,128,128,053,049,055,053,049,055
	              31373531
	              37
 132:     -	62F4  80808020	        DEFB    128,128,128,032,052,056,032,052,056
	              34382034
	              38
 133:     -	62FD  80808032	        DEFB    128,128,128,050,045,084,050,045,084
	              2D54322D
	              54
 134:     -	6306  80808041	        DEFB    128,128,128,065,083,048,065,083,049
	              53304153
	              31
 135:     -	630F  80B0BCBF	        DEFB    128,176,188,191,131,128,128,128,128
	              83808080
	              80
 136:     -	6318  BCBCBC80	        DEFB    188,188,188,128,128,128,128,128,128
	              80808080
	              80
 137:     -	6321  BCBCBC80	        DEFB    188,188,188,128,128,128,176,176,176
	              8080B0B0
	              B0
 138:     -	632A  BCB08080	        DEFB    188,176,128,128,131,191,184,142,129
	              83BFB88E
	              81
 139:     -	6333  B080808F	        DEFB    176,128,128,143,188,176,128,128,131
	              BCB08080
	              83
 140:     -	633C  808080B0	        DEFB    128,128,128,176,176,176,131,131,179
	              B0B08383
	              B3
 141:     -	6345  808080B0	        DEFB    128,128,128,176,176,176,179,131,131
	              B0B0B383
	              83
 142:     -	634E  828BB4B0	        DEFB    130,139,180,176,188,143,131,128,128
	              BC8F8380
	              80
 143:     -	6357  ACBCBCAA	        DEFB    172,188,188,170,149,128,170,149,128
	              9580AA95
	              80
 144:     -	6360  BCBCBC80	        DEFB    188,188,188,128,128,128,128,128,128
	              80808080
	              80
 145:     -	6369  BCBCB480	        DEFB    188,188,180,128,128,128,128,128,128
	              80808080
	              80
 146:     -	6372  B0908080	        DEFB    176,144,128,128,131,189,128,128,191
	              83BD8080
	              BF
 147:     -	637B  AA9580AA	        DEFB    170,149,128,170,149,128,142,143,143
	              95808E8F
	              8F
 148:     -	6384  80808080	        DEFB    128,128,128,128,128,128,143,143,143
	              80808F8F
	              8F
 149:     -	638D  80808080	        DEFB    128,128,128,128,128,128,143,143,135
	              80808F8F
	              87
 150:     -	6396  8080BF80	        DEFB    128,128,191,128,176,159,131,129,128
	              B09F8381
	              80
 151:     -	639F  9FAF9F81	        DEFB    159,175,159,129,170,149,128,170,149
	              AA9580AA
	              95
 152:     -	63A8  AF808082	        DEFB    175,128,128,130,128,128,128,128,128
	              80808080
	              80
 153:     -	63B1  80BAB580	        DEFB    128,186,181,128,128,128,128,128,128
	              80808080
	              80
 154:     -	63BA  80808080	        DEFB    128,128,128,128,128,175,128,128,170
	              80AF8080
	              AA
 155:     -	63C3  8080809F	        DEFB    128,128,128,159,128,128,149,128,128
	              80809580
	              80
 156:     -	63CC  8080AA80	        DEFB    128,128,170,128,128,190,128,128,128
	              80BE8080
	              80
 157:     -	63D5  958080BD	        DEFB    149,128,128,189,128,128,128,128,184
	              80808080
	              B8
 158:     -	63DE  80808080	        DEFB    128,128,128,128,128,128,143,143,190
	              80808F8F
	              BE
 159:     -	63E7  80809580	        DEFB    128,128,149,128,128,149,128,128,139
	              80958080
	              8B
 160:     -	63F0  80808080	        DEFB    128,128,128,128,128,128,188,188,175
	              8080BCBC
	              AF
 161:     -	63F9  80808080	        DEFB    128,128,128,128,128,187,128,160,133
	              80BB80A0
	              85
 162:     -	6402  808080B7	        DEFB    128,128,128,183,128,128,138,144,128
	              80808A90
	              80
 163:     -	640B  80BAB080	        DEFB    128,186,176,128,151,131,128,128,128
	              97838080
	              80
 164:     -	6414  B0B58083	        DEFB    176,181,128,131,171,128,128,128,184
	              AB808080
	              B8
 165:     -	641D  80808080	        DEFB    128,128,128,128,184,143,128,149,128
	              B88F8095
	              80
 166:     -	6426  8080808F	        DEFB    128,128,128,143,180,128,128,170,128
	              B48080AA
	              80
 167:     -	642F  80958080	        DEFB    128,149,128,128,139,188,128,128,128
	              8BBC8080
	              80
 168:     -	6438  80AA80BC	        DEFB    128,170,128,188,135,128,128,128,158
	              87808080
	              9E
 169:     -	6441  80808080	        DEFB    128,128,128,128,128,128,143,143,173
	              80808F8F
	              AD
 170:     -	644A  8080B580	        DEFB    128,128,181,128,128,151,128,128,173
	              80978080
	              AD
 171:     -	6453  B880828B	        DEFB    184,128,130,139,128,160,188,188,158
	              80A0BCBC
	              9E
 172:     -	645C  9783AB95	        DEFB    151,131,171,149,128,170,181,176,186
	              80AAB5B0
	              BA
 173:     -	6465  A8BC94AA	        DEFB    168,188,148,170,128,149,138,143,133
	              80958A8F
	              85
 174:     -	646E  80808080	        DEFB    128,128,128,128,191,128,128,128,128
	              BF808080
	              80
 175:     -	6477  9783AB95	        DEFB    151,131,171,149,088,170,181,176,186
	              58AAB5B0
	              BA
 176:     -	6480  9783AB95	        DEFB    151,131,171,149,079,170,181,176,186
	              4FAAB5B0
	              BA
 177:     -	6489  BF8080BF	        DEFB    191,128,128,191,128,128,191,128,128
	              8080BF80
	              80
 178:     -	6492  8AB58080	        DEFB    138,181,128,128,171,180,128,128,130
	              ABB48080
	              82
 179:     -	649B  80808080	        DEFB    128,128,128,128,128,128,143,188,188
	              80808FBC
	              BC
 180:     -	64A4  80808080	        DEFB    128,128,128,128,128,128,188,188,143
	              8080BCBC
	              8F
 181:     -	64AD  80A0BEB8	        DEFB    128,160,190,184,135,191,129,128,128
	              87BF8180
	              80
 182:     -	64B6  80BF8CAA	        DEFB    128,191,140,170,149,128,191,191,128
	              9580BFBF
	              80
 183:     -	64BF  8C8C8C80	        DEFB    140,140,140,128,128,128,128,128,128
	              80808080
	              80
 184:     -	64C8  8CBF8080	        DEFB    140,191,128,128,170,149,128,191,191
	              AA9580BF
	              BF
 185:     -	64D1  8BBFBF80	        DEFB    139,191,191,128,130,139,128,128,128
	              828B8080
	              80
 186:     -	64DA  878080AD	        DEFB    135,128,128,173,180,128,128,138,181
	              B480808A
	              B5
 187:     -	64E3  80808B80	        DEFB    128,128,139,128,184,158,186,133,128
	              B89EBA85
	              80
 188:     -	64EC  BFBF8787	        DEFB    191,191,135,135,129,128,128,128,128
	              81808080
	              80
 189:     -	64F5  9080808B	        DEFB    144,128,128,139,181,128,128,171,148
	              B58080AB
	              94
 190:     -	64FE  8080BF80	        DEFB    128,128,191,128,128,191,128,128,191
	              80BF8080
	              BF
 191:     -	6507  8BBF8780	        DEFB    139,191,135,128,191,128,168,151,128
	              BF80A897
	              80
 192:     -	6510  8BBF8780	        DEFB    139,191,135,128,191,128,128,171,148
	              BF8080AB
	              94
 193:     -	6519  AEBF8480	        DEFB    174,191,132,128,139,180,128,128,130
	              8BB48080
	              82
 194:     -	6522  80808080	        DEFB    128,128,128,128,128,184,173,158,129
	              80B8AD9E
	              81
 195:     -	652B  808080B4	        DEFB    128,128,128,180,128,128,130,173,158
	              808082AD
	              9E
 196:     -	6534  88BF9DB8	        DEFB    136,191,157,184,135,128,129,128,128
	              87808180
	              80
 197:     -	653D  80808080	        DEFB    128,128,128,128,128,128,128,184,135
	              808080B8
	              87
 198:     -	6546  8080BE80	        DEFB    128,128,190,128,128,128,131,173,144
	              808083AD
	              90
 199:     -	654F  BD808080	        DEFB    189,128,128,128,128,128,128,128,136
	              80808080
	              88
 200:     -	6558  80808080	        DEFB    128,128,128,128,128,128,175,148,128
	              8080AF94
	              80
 201:     -	6561  AA958080	        DEFB    170,149,128,128,175,156,128,128,140
	              AF9C8080
	              8C
 202:     -	656A  80808B80	        DEFB    128,128,139,128,128,128,140,140,140
	              80808C8C
	              8C
 203:     -	6573  B4808082	        DEFB    180,128,128,130,173,176,140,140,140
	              ADB08C8C
	              8C
 204:     -	657C  80BF80B8	        DEFB    128,191,128,184,135,128,140,128,128
	              87808C80
	              80
 205:     -	6585  BFBFBFAA	        DEFB    191,191,191,170,191,191,128,191,191
	              BFBF80BF
	              BF
 206:     -	658E  BFBFBFBF	        DEFB    191,191,191,191,191,149,191,191,128
	              BF95BFBF
	              80
 207:     -	6597  80BFBF80	        DEFB    128,191,191,128,170,191,128,170,191
	              AABF80AA
	              BF
 208:     -	65A0  BFBF80BF	        DEFB    191,191,128,191,149,128,191,149,128
	              9580BF95
	              80
 209:     -	65A9  42414442	        DEFB    066,065,068,066,065,068,066,065,068
	              41444241
	              44
 210:     -	65B2  9783AB95	        DEFB    151,131,171,149,143,170,181,176,186
	              8FAAB5B0
	              BA
 211:				        
 212:				;       These are the 4 x 4 x 4 cell vectors
 213:				        
 214:				;       "TAS PRESENTS"
 215:				        
 216:     -	65BB  00010203	CNFIG0  DEFB    000,001,002,003,004,005,006,004
	              04050604
 217:     -	65C3  04070804	        DEFB    004,007,008,004,004,009,010,011
	              04090A0B
 218:     -	65CB  040C0D04	        DEFB    004,012,013,004,004,014,015,004
	              040E0F04
 219:     -	65D3  10111213	        DEFB    016,017,018,019,020,021,022,023
	              14151617
 220:     -	65DB  18191A1B	        DEFB    024,025,026,027,028,029,030,004
	              1C1D1E04
 221:     -	65E3  041F2021	        DEFB    004,031,032,033,034,035,036,037
	              22232425
 222:     -	65EB  26272829	        DEFB    038,039,040,041,004,004,004,004
	              04040404
 223:     -	65F3  04040404	        DEFB    004,004,004,004,042,043,044,045
	              2A2B2C2D
 224:				        
 225:				;       "3-D TIC TAC TOE"
 226:				        
 227:     -	65FB  2E2F3031	CNFIG1  DEFB    046,047,048,049,050,051,052,053
	              32333435
 228:     -	6603  36373839	        DEFB    054,055,056,057,058,059,060,061
	              3A3B3C3D
 229:     -	660B  3E3F0404	        DEFB    062,063,004,004,064,065,066,004
	              40414204
 230:     -	6613  04434445	        DEFB    004,067,068,069,004,004,070,071
	              04044647
 231:     -	661B  3E3F0404	        DEFB    062,063,004,004,064,072,073,004
	              40484904
 232:     -	6623  044A4B45	        DEFB    004,074,075,069,004,004,070,071
	              04044647
 233:     -	662B  3E3F0404	        DEFB    062,063,004,004,064,076,077,004
	              404C4D04
 234:     -	6633  044E4F50	        DEFB    004,078,079,080,004,004,081,082
	              04045152
 235:				        
 236:				;       Play set-up
 237:				        
 238:     -	663B  53535353	CNFIG2  DEFB    083,083,083,083,083,083,083,083
	              53535353
 239:     -	6643  53535353	        DEFB    083,083,083,083,083,083,083,083
	              53535353
 240:     -	664B  53535353	        DEFB    083,083,083,083,083,083,083,083
	              53535353
 241:     -	6653  53535353	        DEFB    083,083,083,083,083,083,083,083
	              53535353
 242:     -	665B  53535353	        DEFB    083,083,083,083,083,083,083,083
	              53535353
 243:     -	6663  53535353	        DEFB    083,083,083,083,083,083,083,083
	              53535353
 244:     -	666B  53535353	        DEFB    083,083,083,083,083,083,083,083
	              53535353
 245:     -	6673  53535353	        DEFB    083,083,083,083,083,083,083,083
	              53535353
 246:				        
 247:				;       "YOU WIN"
 248:				        
 249:     -	667B  60616263	CNFIG3  DEFB    096,097,098,099,004,005,006,004
	              04050604
 250:     -	6683  04070804	        DEFB    004,007,008,004,004,009,010,004
	              04090A04
 251:     -	668B  18191A64	        DEFB    024,025,026,100,088,004,004,101
	              58040465
 252:     -	6693  58040465	        DEFB    088,004,004,101,089,090,091,037
	              595A5B25
 253:     -	669B  66040467	        DEFB    102,004,004,103,088,004,004,101
	              58040465
 254:     -	66A3  58040465	        DEFB    088,004,004,101,089,090,091,037
	              595A5B25
 255:     -	66AB  68696A6B	        DEFB    104,105,106,107,004,065,066,004
	              04414204
 256:     -	66B3  6C6D6E6F	        DEFB    108,109,110,111,112,113,114,115
	              70717273
 257:				        
 258:				;       "I WIN"
 259:				        
 260:     -	66BB  04040404	CNFIG4  DEFB    004,004,004,004,004,004,004,004
	              04040404
 261:     -	66C3  04040404	        DEFB    004,004,004,004,004,004,004,004
	              04040404
 262:     -	66CB  04747504	        DEFB    004,116,117,004,004,118,119,004
	              04767704
 263:     -	66D3  04070804	        DEFB    004,007,008,004,004,009,010,004
	              04090A04
 264:     -	66DB  04040404	        DEFB    004,004,004,004,004,004,004,004
	              04040404
 265:     -	66E3  04040404	        DEFB    004,004,004,004,004,004,004,004
	              04040404
 266:     -	66EB  68696A6B	        DEFB    104,105,106,107,004,065,066,004
	              04414204
 267:     -	66F3  6C6D6E6F	        DEFB    108,109,110,111,112,113,114,115
	              70717273
 268:				        
 269:				;       "CATS"
 270:				        
 271:     -	66FB  18191A1B	CNFIG5  DEFB    024,025,026,027,088,004,004,004
	              58040404
 272:     -	6703  58040404	        DEFB    088,004,004,004,089,090,091,092
	              595A5B5C
 273:     -	670B  040C0D04	        DEFB    004,012,013,004,004,014,015,004
	              040E0F04
 274:     -	6713  10111213	        DEFB    016,017,018,019,093,094,094,095
	              5D5E5E5F
 275:     -	671B  00010203	        DEFB    000,001,002,003,004,005,006,004
	              04050604
 276:     -	6723  04070804	        DEFB    004,007,008,004,004,009,010,004
	              04090A04
 277:     -	672B  18191A1B	        DEFB    024,025,026,027,028,029,030,004
	              1C1D1E04
 278:     -	6733  041F2021	        DEFB    004,031,032,033,034,090,091,037
	              225A5B25
 279:				        
 280:				;       [ blank screen ]
 281:				        
 282:     -	673B  04040404	CNFIG6  DEFB    004,004,004,004,004,004,004,004
	              04040404
 283:     -	6743  04040404	        DEFB    004,004,004,004,004,004,004,004
	              04040404
 284:     -	674B  04040404	        DEFB    004,004,004,004,004,004,004,004
	              04040404
 285:     -	6753  04040404	        DEFB    004,004,004,004,004,004,004,004
	              04040404
 286:     -	675B  04040404	        DEFB    004,004,004,004,004,004,004,004
	              04040404
 287:     -	6763  04040404	        DEFB    004,004,004,004,004,004,004,004
	              04040404
 288:     -	676B  04040404	        DEFB    004,004,004,004,004,004,004,004
	              04040404
 289:     -	6773  04040404	        DEFB    004,004,004,004,004,004,004,004
	              04040404
 290:				        
 291:     -	677B          	SCORES  DEFS    40H             ;Holds "grades" for moves
 292:				        
 293:     -	67BB          	SRTREF  DEFS    40H             ;Holds sort reference
 294:				        
 295:     -	67FB  01020304	EXPTBL  DEFB    1,2,3,4         ;Level   I
 296:     -	67FF  01020408	        DEFB    1,2,4,8         ;Level  II
 297:     -	6803  0102040C	        DEFB    1,2,4,12        ;Level III
 298:     -	6807  01030924	        DEFB    1,3,9,36        ;Level  IV
 299:     -	680B  01030940	        DEFB    1,3,9,64        ;Level   V
 300:     -	680F  0368    	EXPTBX  DEFW    EXPTBL+8
 301:     -	6811  00      	BRDPOS  DEFB    0               ;Holds player cursor posn
 302:     -	6812  0000    	RNDPNT  DEFW    0               ;Holds loc of random #
 303:				        
 304:				;       -- SOME TEXT FOR THE FANCY SCREEN STUFF
 305:				        
 306:				        
 307:				;       -- MESSAGES FOR THE BOTTOM OF THE SCREEN
 308:				        
 309:     -	6814  07      	MESS1   DEFB    7
 310:     -	6815  4C657665	        DEFM    'Level of play?  '
	              6C206F66
	              20706C61
	              793F2020
 311:     -	6825  20282031	        DEFM    ' ( 1 - EASY  thru  5 - DIFFICULT )'
	              202D2045
	              41535920
	              20746872
	              75202035
	              202D2044
	              49464649
	              43554C54
	              2029
 312:     -	6847  00      	        DEFB    0
 313:				        
 314:     -	6848  07      	MESS2   DEFB    7
 315:     -	6849  446F2079	        DEFM    'Do you wish to flip for FIRST MOVE?  '
	              6F752077
	              69736820
	              746F2066
	              6C697020
	              666F7220
	              46495253
	              54204D4F
	              56453F20
	              20
 316:     -	686E  20202820	        DEFM    '  ( Y = YES )'
	              59203D20
	              59455320
	              29
 317:     -	687B  00      	        DEFB    0
 318:				        
 319:     -	687C  14      	MESS3   DEFB    14H
 320:     -	687D  596F7520	        DEFM    'You (O) or Me (X) FIRST?'
	              284F2920
	              6F72204D
	              65202858
	              29204649
	              5253543F
 321:     -	6895  00      	        DEFB    0
 322:				        
 323:     -	6896  16      	MESS4   DEFB    16H
 324:     -	6897  48454144	        DEFM    'HEADS -- It'
	              53202D2D
	              204974
 325:     -	68A2  27      	        DEFB    27H
 326:     -	68A3  7320596F	        DEFM    's Yours!'
	              75727321
 327:     -	68AB  00      	        DEFB    0
 328:				        
 329:     -	68AC  16      	MESS5   DEFB    16H
 330:     -	68AD  5441494C	        DEFM    'TAILS -- It'
	              53202D2D
	              204974
 331:     -	68B8  27      	        DEFB    27H
 332:     -	68B9  73204D69	        DEFM    's Mine!'
	              6E6521
 333:     -	68C0  00      	        DEFB    0
 334:				        
 335:     -	68C1  15      	MESS6   DEFB    15H
 336:     -	68C2  50726573	        DEFM    'Press < CLEAR > to Play'
	              73203C20
	              434C4541
	              52203E20
	              746F2050
	              6C6179
 337:     -	68D9  00      	        DEFB    0
 338:				        
 339:     -	68DA  05      	MESS7   DEFB    5
 340:     -	68DB  3C205269	        DEFM    '< Right/Left Arrows moves Cursor > '
	              6768742F
	              4C656674
	              20417272
	              6F777320
	              6D6F7665
	              73204375
	              72736F72
	              203E20
 341:     -	68FE  203C2022	        DEFM    ' < "O" makes Move >'
	              4F22206D
	              616B6573
	              204D6F76
	              65203E
 342:     -	6911  00      	        DEFB    0
 343:				        
 344:				        
 345:				;       -- NOW LOCNS AND A ROM CALL
 346:				        
 347:     -	3802          	NOKEY   EQU     3802H   ;'N' & 'O' KEY
 348:     -	3808          	YXKEY   EQU     3808H   ;'Y' & 'X' KEY
 349:     -	3810          	NUMKEY  EQU     3810H   ;0 THRU 7
 350:     -	3840          	ARWKEY  EQU     3840H   ;Arrow and <CLEAR> key
 351:     -	3C45          	LOCZER  EQU     03C45H  ;Loc of first move on screen
 352:     -	01C9          	CLEAR   EQU     001C9H  ;Clears screen
 353:				        
 354:				        
 355:				        
 356:				        
 357:				;       ***********************
 358:				;       *   FANCY   OPENING   *
 359:				;       *       NUMBER        *
 360:				;       ***********************
 361:				        
 362:				        
 363:				        
 364:    0+9	6912  ED5F    	START:  LD      A,R
 365:    9+13	6914  321268  	        LD      (RNDPNT),A      ;Initialize random pntr.
 366:   22+10	6917  31FFFF  	        LD      SP,0FFFFH       ;Initialize Stack
 367:				        
 368:   32+17	691A  CDC901  	        CALL    CLEAR           ;Clear screen
 369:				        
 370:   49+14	691D  DD21BB65	CYCLE:  LD      IX,CNFIG0       ;'flrout' = fill routine
 371:   63+17	6921  CDA269  	        CALL    SCRFIL
 372:   80+7	6924  0600    	        LD      B,0
 373:   87+17	6926  CD746A  	        CALL    PAUSE
 374:  104+17	6929  CD746A  	        CALL    PAUSE
 375:  121+17	692C  CD746A  	        CALL    PAUSE
 376:  138+17	692F  CD746A  	        CALL    PAUSE
 377:  155+17	6932  CD746A  	        CALL    PAUSE
 378:  172+17	6935  CD746A  	        CALL    PAUSE
 379:  189+17	6938  CD746A  	        CALL    PAUSE
 380:				        
 381:  206+14	693B  DD21FB65	        LD      IX,CNFIG1
 382:  220+17	693F  CDA269  	        CALL    SCRFIL
 383:  237+7	6942  0600    	        LD      B,0
 384:  244+17	6944  CD746A  	        CALL    PAUSE
 385:  261+17	6947  CD746A  	        CALL    PAUSE
 386:  278+17	694A  CD746A  	        CALL    PAUSE
 387:  295+17	694D  CD746A  	        CALL    PAUSE
 388:  312+17	6950  CD746A  	        CALL    PAUSE
 389:  329+17	6953  CD746A  	        CALL    PAUSE
 390:				        
 391:  346+14	6956  DD213B66	        LD      IX,CNFIG2
 392:  360+17	695A  CDA269  	        CALL    SCRFIL
 393:  377+7	695D  0680    	        LD      B,80H
 394:  384+17	695F  CD746A  	        CALL    PAUSE
 395:  401+10	6962  21C168  	        LD      HL,MESS6
 396:  411+17	6965  CD566B  	        CALL    MDSPLY
 397:  428+7	6968  0680    	        LD      B,80H
 398:  435+17	696A  CD746A  	        CALL    PAUSE
 399:  452+17	696D  CD9A6C  	        CALL    NEWBRD          ;Prepare for simul. play
 400:				        
 401:  469+17	6970  CDA86C  	SIMLTE: CALL    ANLYZE          ;On return:
 402:				;                                A = 0 MEANS 'ALL WELL'
 403:				;                                   HL <= COUNTER MOVE
 404:				;                                A = 1  MEANS 'WIN'
 405:				;                                   DE <= REFTBL ROW VECT
 406:				;                                A = 2  MEANS 'CATS'
 407:				;                                   NO PERTINENT VECTOR
 408:				        
 409:  486+4	6973  B7      	        OR      A       ;'all well'?
 410:  490+7+5	6974  201F    	        JR      NZ,SIMOUT
 411:  497+11	6976  E5      	        PUSH    HL              ;Save move
 412:  508+10	6977  010060  	        LD      BC,BOARD
 413:  518+11	697A  09      	        ADD     HL,BC
 414:  529+10	697B  3601    	SIMTOK: LD      (HL),01H
 415:  539+13	697D  3A7C69  	        LD      A,(SIMTOK+1)
 416:  552+7	6980  EE11    	        XOR     11H             ;Toggle token type
 417:  559+13	6982  327C69  	        LD      (SIMTOK+1),A
 418:  572+10	6985  E1      	        POP     HL              ;Get move back
 419:  582+7	6986  0664    	        LD      B,100           ;Flash move counter
 420:  589+17	6988  CD996A  	        CALL    FLSHMV  ;Flash it
 421:				        
 422:  606+13	698B  3A4038  	        LD      A,(ARWKEY)
 423:  619+7	698E  FE02    	        CP      2
 424:  626+10	6990  CADF6A  	        JP      Z,GAME
 425:				        
 426:  636+12	6993  18DB    	        JR      SIMLTE
 427:				        
 428:  648+7	6995  FE01    	SIMOUT: CP      1               ;Test for win
 429:  655+10+7	6997  CC7D6A  	        CALL    Z,FLSHRW        ;Flshrw if win
 430:				        
 431:  665+7	699A  06A0    	        LD      B,0A0H
 432:  672+17	699C  CD746A  	        CALL    PAUSE
 433:  689+10	699F  C31D69  	        JP      CYCLE
 434:				        
 435:				        
 436:  699+17	69A2  CD9A6C  	SCRFIL: CALL    NEWBRD
 437:  716+7	69A5  0640    	        LD      B,64            ;Count for board fill
 438:				        
 439:  723+11	69A7  C5      	NXTLOC: PUSH    BC              ;Save it
 440:  734+14	69A8  FD210060	        LD      IY,BOARD
 441:  748+15	69AC  DDE5    	        PUSH    IX              ;Save cnfigx
 442:				        
 443:  763+17	69AE  CDBF6D  	LKAGIN: CALL    RANDOM
 444:  780+7	69B1  E63F    	        AND     3FH             ;0 <= A <= 63
 445:  787+4	69B3  6F      	        LD      L,A
 446:  791+13	69B4  32BC69  	        LD      (IYCD60+2),A
 447:  804+13	69B7  32C269  	        LD      (IYCD61+2),A
 448:  817+19	69BA  FD7E00  	IYCD60: LD      A,(IY+0)
 449:  836+4	69BD  B7      	        OR      A               ;Check board for zero
 450:  840+7+5	69BE  20EE    	        JR      NZ,LKAGIN       ;If not 0 , 'look again'
 451:				        
 452:  847+23	69C0  FD3400  	IYCD61: INC     (IY+0)          ;Set board for next time
 453:  870+4	69C3  7D      	        LD      A,L
 454:  874+14	69C4  DDE1    	        POP     IX              ;Get back cnfigx
 455:  888+13	69C6  32CB69  	        LD      (IXCD60+2),A
 456:  901+19	69C9  DD7E00  	IXCD60: LD      A,(IX+0)        ;A = desired configuratn
 457:  920+4	69CC  67      	        LD      H,A
 458:  924+15	69CD  DDE5    	        PUSH    IX              ;Save that cnfigx
 459:				        
 460:  939+7	69CF  0608    	        LD      B,8
 461:  946+17	69D1  CD746A  	        CALL    PAUSE
 462:  963+17	69D4  CDE569  	        CALL    LOCFIL          ;H = CONFIG / L = BRD LOC
 463:				        
 464:  980+13	69D7  3A4038  	        LD      A,(ARWKEY)
 465:  993+7	69DA  FE02    	        CP      2
 466:				        
 467: 1000+14	69DC  DDE1    	        POP     IX
 468: 1014+10	69DE  C1      	        POP     BC              ;Get back count
 469: 1024+10	69DF  CADF6A  	        JP      Z,GAME
 470:				        
 471: 1034+8+5	69E2  10C3    	        DJNZ    NXTLOC
 472: 1042+10	69E4  C9      	        RET                     ;Back to main stream
 473:				        
 474:				        
 475:				        
 476: 1052+11	69E5  E5      	LOCFIL: PUSH    HL              ;Save config/board loctn
 477:				        
 478: 1063+7	69E6  0601    	        LD      B,1
 479: 1070+4	69E8  7D      	        LD      A,L
 480: 1074+7	69E9  FE10    	PANEL:  CP      16              ;Check board > 15
 481: 1081+7+5	69EB  3805    	        JR      C,ROWCON
 482: 1088+4	69ED  04      	        INC     B
 483: 1092+7	69EE  D610    	        SUB     16              ;We'll try again
 484: 1099+12	69F0  18F7    	        JR      PANEL
 485:				        
 486: 1111+4	69F2  4F      	ROWCON: LD      C,A             ;B has count
 487: 1115+7	69F3  3EF2    	        LD      A,0F2H          ;0F2H = -14
 488: 1122+7	69F5  C60E    	PNLOOP: ADD     A,14
 489: 1129+8+5	69F7  10FC    	        DJNZ    PNLOOP          ;Add 14 for @ mod16
 490:				        
 491: 1137+4	69F9  5F      	        LD      E,A
 492: 1141+7	69FA  1600    	        LD      D,0
 493: 1148+11	69FC  D5      	        PUSH    DE              ;Stash this panel disp
 494:				        
 495: 1159+7	69FD  0601    	        LD      B,1
 496: 1166+4	69FF  79      	        LD      A,C             ;Get remainder
 497:				        
 498: 1170+7	6A00  FE04    	ROW:    CP      4
 499: 1177+7+5	6A02  3805    	        JR      C,COLCON
 500: 1184+4	6A04  04      	        INC     B
 501: 1188+7	6A05  D604    	        SUB     4
 502: 1195+12	6A07  18F7    	        JR      ROW
 503:				        
 504: 1207+10	6A09  2140FF  	COLCON: LD      HL,0FF40H
 505: 1217+10	6A0C  11C000  	        LD      DE,000C0H
 506:				        
 507: 1227+11	6A0F  19      	ROWLOP: ADD     HL,DE
 508: 1238+8+5	6A10  10FD    	        DJNZ    ROWLOP
 509:				        
 510: 1246+11	6A12  E5      	        PUSH    HL
 511: 1257+4	6A13  4F      	        LD      C,A
 512: 1261+4	6A14  07      	        RLCA
 513: 1265+4	6A15  81      	        ADD     A,C
 514: 1269+4	6A16  5F      	        LD      E,A
 515: 1273+7	6A17  1600    	        LD      D,0
 516: 1280+10	6A19  21453C  	        LD      HL,LOCZER
 517: 1290+11	6A1C  19      	        ADD     HL,DE
 518: 1301+10	6A1D  D1      	        POP     DE
 519: 1311+11	6A1E  19      	        ADD     HL,DE
 520: 1322+10	6A1F  D1      	        POP     DE
 521: 1332+11	6A20  19      	        ADD     HL,DE
 522:				        
 523: 1343+11	6A21  E5      	        PUSH    HL
 524: 1354+14	6A22  FDE1    	        POP     IY
 525:				        
 526: 1368+10	6A24  E1      	        POP     HL
 527: 1378+4	6A25  6C      	        LD      L,H
 528: 1382+7	6A26  2600    	        LD      H,0
 529: 1389+11	6A28  E5      	        PUSH    HL
 530: 1400+10	6A29  C1      	        POP     BC
 531:				        
 532: 1410+11	6A2A  29      	        ADD     HL,HL
 533: 1421+11	6A2B  29      	        ADD     HL,HL
 534: 1432+11	6A2C  29      	        ADD     HL,HL
 535: 1443+11	6A2D  09      	        ADD     HL,BC
 536: 1454+11	6A2E  E5      	        PUSH    HL
 537: 1465+10	6A2F  C1      	        POP     BC
 538:				        
 539: 1475+14	6A30  DD217161	        LD      IX,FIGMAT
 540: 1489+15	6A34  DD09    	        ADD     IX,BC
 541:				        
 542: 1504+10	6A36  014000  	        LD      BC,64
 543: 1514+19	6A39  DD7E00  	        LD      A,(IX+0)
 544: 1533+19	6A3C  FD7700  	        LD      (IY+0),A
 545: 1552+19	6A3F  DD7E01  	        LD      A,(IX+1)
 546: 1571+19	6A42  FD7701  	        LD      (IY+1),A
 547: 1590+19	6A45  DD7E02  	        LD      A,(IX+2)
 548: 1609+19	6A48  FD7702  	        LD      (IY+2),A
 549:				        
 550: 1628+15	6A4B  FD09    	        ADD     IY,BC
 551: 1643+19	6A4D  DD7E03  	        LD      A,(IX+3)
 552: 1662+19	6A50  FD7700  	        LD      (IY+0),A
 553: 1681+19	6A53  DD7E04  	        LD      A,(IX+4)
 554: 1700+19	6A56  FD7701  	        LD      (IY+1),A
 555: 1719+19	6A59  DD7E05  	        LD      A,(IX+5)
 556: 1738+19	6A5C  FD7702  	        LD      (IY+2),A
 557:				        
 558:				        
 559:				        
 560:				        
 561:				        
 562: 1757+15	6A5F  FD09    	        ADD     IY,BC
 563: 1772+19	6A61  DD7E06  	        LD      A,(IX+6)
 564: 1791+19	6A64  FD7700  	        LD      (IY+0),A
 565: 1810+19	6A67  DD7E07  	        LD      A,(IX+7)
 566: 1829+19	6A6A  FD7701  	        LD      (IY+1),A
 567: 1848+19	6A6D  DD7E08  	        LD      A,(IX+8)
 568: 1867+19	6A70  FD7702  	        LD      (IY+2),A
 569:				        
 570: 1886+10	6A73  C9      	        RET
 571:				        
 572:				        
 573: 1896+11	6A74  C5      	PAUSE:  PUSH    BC
 574: 1907+7	6A75  0600    	        LD      B,0
 575: 1914+8+5	6A77  10FE    	PSLOP2: DJNZ    PSLOP2
 576: 1922+10	6A79  C1      	        POP     BC
 577: 1932+8+5	6A7A  10F8    	        DJNZ    PAUSE
 578: 1940+10	6A7C  C9      	        RET
 579:				        
 580:				        
 581:				        
 582:				;       THIS IS THE FLASHING ROW SUBROUTINE
 583:				        
 584: 1950+4	6A7D  EB      	FLSHRW: EX      DE,HL           ;HL <= loc / row pointers
 585: 1954+7	6A7E  0610    	        LD      B,10H           ;Number of 4 cycles
 586:				        
 587: 1961+11	6A80  C5      	FLRWL1: PUSH    BC              ;'flash row loop 1'
 588: 1972+11	6A81  E5      	        PUSH    HL
 589: 1983+7	6A82  0604    	        LD      B,4
 590:				        
 591: 1990+11	6A84  C5      	FLRWL2: PUSH    BC
 592: 2001+11	6A85  E5      	        PUSH    HL
 593: 2012+7	6A86  060A    	        LD      B,10            ;Number of 'flash' cycles
 594: 2019+7	6A88  7E      	        LD      A,(HL)
 595: 2026+4	6A89  6F      	        LD      L,A
 596: 2030+7	6A8A  2600    	        LD      H,0
 597:				        
 598: 2037+17	6A8C  CD996A  	        CALL    FLSHMV
 599:				        
 600: 2054+10	6A8F  E1      	        POP     HL
 601: 2064+6	6A90  23      	        INC     HL              ;To flash next winning
 602:				;                                move spot 10 times
 603: 2070+10	6A91  C1      	        POP     BC
 604: 2080+8+5	6A92  10F0    	        DJNZ    FLRWL2
 605:				        
 606: 2088+10	6A94  E1      	        POP     HL              ;Get back 1st pointer
 607: 2098+10	6A95  C1      	        POP     BC              ;& 20 count
 608: 2108+8+5	6A96  10E8    	        DJNZ    FLRWL1
 609:				        
 610: 2116+10	6A98  C9      	        RET
 611:				        
 612:				        
 613:				;       -- HERE'S WHERE WE FLASH AN INDIVIDUAL 'QUAD'
 614:				        
 615:				        
 616: 2126+11	6A99  E5      	FLSHMV: PUSH    HL              ;Save move for later
 617:				        
 618: 2137+11	6A9A  C5      	FLMVLP: PUSH    BC              ;Stash that loop value
 619: 2148+7	6A9B  2653    	        LD      H,53H           ;'o' grafix unit
 620: 2155+11	6A9D  E5      	        PUSH    HL
 621: 2166+17	6A9E  CDE569  	        CALL    LOCFIL          ;Write it
 622: 2183+7	6AA1  0601    	        LD      B,1
 623: 2190+17	6AA3  CD746A  	        CALL    PAUSE
 624: 2207+10	6AA6  E1      	        POP     HL
 625: 2217+4	6AA7  24      	        INC     H               ;Next, smaller 'o' unit
 626: 2221+11	6AA8  E5      	        PUSH    HL
 627: 2232+17	6AA9  CDE569  	        CALL    LOCFIL          ;Write it
 628: 2249+7	6AAC  0601    	        LD      B,1
 629: 2256+17	6AAE  CD746A  	        CALL    PAUSE
 630: 2273+10	6AB1  E1      	        POP     HL
 631: 2283+4	6AB2  24      	        INC     H               ;Next, smallest '.' unit
 632: 2287+11	6AB3  E5      	        PUSH    HL
 633: 2298+17	6AB4  CDE569  	        CALL    LOCFIL          ;Write it
 634: 2315+7	6AB7  0601    	        LD      B,1
 635: 2322+17	6AB9  CD746A  	        CALL    PAUSE
 636: 2339+10	6ABC  E1      	        POP     HL
 637:				        
 638: 2349+10	6ABD  C1      	        POP     BC              ;Get back flash count
 639: 2359+8+5	6ABE  10DA    	        DJNZ    FLMVLP
 640:				        
 641: 2367+10	6AC0  E1      	        POP     HL              ;Get back move loc
 642: 2377+17	6AC1  CDC56A  	        CALL    PUTTOK          ;Puts token on screen
 643:				        
 644: 2394+10	6AC4  C9      	        RET
 645:				        
 646:				        
 647:				        
 648: 2404+10	6AC5  010060  	PUTTOK: LD      BC,BOARD
 649: 2414+11	6AC8  09      	        ADD     HL,BC           ;HL <= BOARD LOC
 650: 2425+7	6AC9  7E      	        LD      A,(HL)          ;A  <= TOKEN
 651:				        
 652: 2432+4	6ACA  B7      	        OR      A       ;Empty move place?
 653: 2436+7+5	6ACB  280C    	        JR      Z,BLNKTK        ;Put blank token
 654:				        
 655: 2443+7	6ACD  FE01    	        CP      01H     ;'o' move place?
 656: 2450+7+5	6ACF  2804    	        JR      Z,OHTK          ;Put  'o'  token
 657:				        
 658: 2457+7	6AD1  2656    	        LD      H,56H   ;Else set up 'x' token
 659: 2464+12	6AD3  1806    	        JR      CNTFIL
 660: 2476+7	6AD5  2657    	OHTK:   LD      H,57H   ;'o' token
 661: 2483+12	6AD7  1802    	        JR      CNTFIL
 662: 2495+7	6AD9  2653    	BLNKTK: LD      H,53H   ;Blank token
 663:				        
 664: 2502+17	6ADB  CDE569  	CNTFIL: CALL    LOCFIL  ;Fill 'er up!
 665:				        
 666: 2519+10	6ADE  C9      	        RET
 667:				        
 668:				        
 669: 2529+17	6ADF  CD486B  	GAME:   CALL    CLRLIN
 670: 2546+14	6AE2  DD213B67	        LD      IX,CNFIG6       ;Clear screen
 671: 2560+17	6AE6  CDA269  	        CALL    SCRFIL
 672: 2577+14	6AE9  DD213B66	        LD      IX,CNFIG2       ;Play set up
 673: 2591+17	6AED  CDA269  	        CALL    SCRFIL
 674: 2608+7	6AF0  0600    	        LD      B,0
 675: 2615+17	6AF2  CD746A  	        CALL    PAUSE
 676: 2632+17	6AF5  CD9A6C  	        CALL    NEWBRD
 677: 2649+10	6AF8  211468  	        LD      HL,MESS1
 678: 2659+17	6AFB  CD566B  	        CALL    MDSPLY          ;'level of play' mess
 679:				        
 680: 2676+13	6AFE  3A1038  	GETNUM: LD      A,(NUMKEY)
 681: 2689+4	6B01  1F      	        RRA                     ;Cycle out zero key
 682: 2693+7	6B02  0605    	        LD      B,5             ;Cycle out 5 bits
 683: 2700+4	6B04  1F      	NXBYT1: RRA
 684: 2704+7+5	6B05  3804    	        JR      C,GOTNUM
 685: 2711+8+5	6B07  10FB    	        DJNZ    NXBYT1
 686: 2719+12	6B09  18F3    	        JR      GETNUM          ;No findee -- try again.
 687:				        
 688: 2731+7	6B0B  3E05    	GOTNUM: LD      A,5
 689: 2738+4	6B0D  90      	        SUB     B               ; A <= 0 THRU 4
 690: 2742+4	6B0E  07      	        RLCA
 691: 2746+4	6B0F  07      	        RLCA                    ; A <= 0,4,8,10,14 HEX
 692: 2750+4	6B10  4F      	        LD      C,A
 693: 2754+7	6B11  0600    	        LD      B,0
 694: 2761+10	6B13  21FB67  	        LD      HL,EXPTBL
 695: 2771+11	6B16  09      	        ADD     HL,BC
 696: 2782+16	6B17  220F68  	        LD      (EXPTBX),HL
 697: 2798+17	6B1A  CD486B  	        CALL    CLRLIN          ;Clear message line
 698:				        
 699: 2815+10	6B1D  214868  	        LD      HL,MESS2        ;'flip?'
 700: 2825+17	6B20  CD566B  	        CALL    MDSPLY
 701:				        
 702: 2842+13	6B23  3A0838  	GETFLP: LD      A,(YXKEY)       ;'Y'?
 703: 2855+4	6B26  B7      	        OR      A
 704: 2859+7+5	6B27  2040    	        JR      NZ,FLIP
 705: 2866+13	6B29  3A0238  	        LD      A,(NOKEY)       ;'N'?
 706: 2879+4	6B2C  B7      	        OR      A
 707: 2883+7+5	6B2D  28F4    	        JR      Z,GETFLP        ;Not 'n' , try again.
 708:				        
 709: 2890+17	6B2F  CD486B  	        CALL    CLRLIN          ;Wants choice/clear mess.
 710: 2907+10	6B32  217C68  	        LD      HL,MESS3        ;''O' OR 'X' FIRST?'
 711: 2917+17	6B35  CD566B  	        CALL    MDSPLY
 712: 2934+13	6B38  3A0238  	GETCHO: LD      A,(NOKEY)
 713: 2947+7	6B3B  FE80    	        CP      80H             ;Bit 7 alone
 714: 2954+7+5	6B3D  2855    	        JR      Z,OFIRST-6      ;If nokey, player first.
 715: 2961+13	6B3F  3A0838  	        LD      A,(YXKEY)
 716: 2974+4	6B42  B7      	        OR      A
 717: 2978+7+5	6B43  28F3    	        JR      Z,GETCHO
 718:				        
 719: 2985+10	6B45  C3616C  	        JP      XFIRST
 720:				        
 721:				;       >> some subroutines <<
 722:				        
 723: 2995+10	6B48  21803F  	CLRLIN: LD      HL,3F80H        ;Crt, beg. of line 14
 724: 3005+11	6B4B  E5      	        PUSH    HL
 725: 3016+10	6B4C  D1      	        POP     DE
 726: 3026+6	6B4D  13      	        INC     DE
 727: 3032+10	6B4E  3620    	        LD      (HL),20H        ;Load up first space
 728: 3042+10	6B50  014000  	        LD      BC,40H
 729: 3052+16+5	6B53  EDB0    	        LDIR            ;Move spaces.
 730: 3068+10	6B55  C9      	        RET
 731:				        
 732: 3078+7	6B56  7E      	MDSPLY: LD      A,(HL)          ;A <= tab
 733: 3085+6	6B57  23      	        INC     HL              ;HL <= 1ST BYTE OF MESSx
 734: 3091+11	6B58  E5      	        PUSH    HL              ;Save it
 735: 3102+4	6B59  5F      	        LD      E,A
 736: 3106+7	6B5A  1600    	        LD      D,0
 737: 3113+10	6B5C  21803F  	        LD      HL,3F80H
 738: 3123+11	6B5F  19      	        ADD     HL,DE
 739: 3134+4	6B60  EB      	        EX      DE,HL           ;DE <= CRT DESTINATION
 740: 3138+10	6B61  E1      	        POP     HL              ;Get source string back
 741: 3148+16	6B62  EDA0    	MESSLP: LDI             ;Transfer message byte
 742: 3164+7	6B64  7E      	        LD      A,(HL)
 743: 3171+4	6B65  B7      	        OR      A
 744: 3175+7+5	6B66  20FA    	        JR      NZ,MESSLP       ;If new (HL) <> 0, again
 745: 3182+10	6B68  C9      	        RET
 746:				        
 747: 3192+17	6B69  CD486B  	FLIP:   CALL    CLRLIN
 748: 3209+17	6B6C  CDBF6D  	        CALL    RANDOM
 749: 3226+4	6B6F  0F      	        RRCA
 750: 3230+7+5	6B70  3814    	        JR      C,O1STMS
 751: 3237+10	6B72  21AC68  	        LD      HL,MESS5        ;'tails'
 752: 3247+17	6B75  CD566B  	        CALL    MDSPLY
 753: 3264+7	6B78  0600    	        LD      B,0
 754: 3271+17	6B7A  CD746A  	        CALL    PAUSE
 755: 3288+17	6B7D  CD746A  	        CALL    PAUSE
 756: 3305+17	6B80  CD486B  	        CALL    CLRLIN
 757: 3322+10	6B83  C3616C  	        JP      XFIRST
 758:				        
 759: 3332+10	6B86  219668  	O1STMS: LD      HL,MESS4        ;'heads'
 760: 3342+17	6B89  CD566B  	        CALL    MDSPLY
 761: 3359+7	6B8C  0600    	        LD      B,0
 762: 3366+17	6B8E  CD746A  	        CALL    PAUSE
 763: 3383+17	6B91  CD746A  	        CALL    PAUSE
 764: 3400+10	6B94  21DA68  	        LD      HL,MESS7
 765: 3410+17	6B97  CD566B  	        CALL    MDSPLY
 766:				        
 767: 3427+10	6B9A  210060  	OFIRST: LD      HL,BOARD
 768: 3437+10	6B9D  010000  	        LD      BC,0
 769: 3447+7	6BA0  3E00    	        LD      A,0
 770: 3454+16+5	6BA2  EDB1    	        CPIR
 771: 3470+6	6BA4  2B      	        DEC     HL
 772: 3476+7	6BA5  2679    	        LD      H,79H
 773: 3483+4	6BA7  7D      	        LD      A,L
 774: 3487+13	6BA8  321168  	        LD      (BRDPOS),A
 775: 3500+17	6BAB  CDE569  	        CALL    LOCFIL
 776: 3517+7	6BAE  0600    	        LD      B,0
 777: 3524+17	6BB0  CD746A  	        CALL    PAUSE
 778:				        
 779: 3541+13	6BB3  3A4038  	PLAYIN: LD      A,(ARWKEY)
 780: 3554+7	6BB6  0614    	        LD      B,20
 781: 3561+17	6BB8  CD746A  	        CALL    PAUSE   ;Pause for "debounce"
 782: 3578+4	6BBB  1F      	        RRA
 783: 3582+4	6BBC  1F      	        RRA
 784: 3586+4	6BBD  1F      	        RRA
 785: 3590+4	6BBE  1F      	        RRA             ;Rotate up arrow bit into 'a' reg
 786: 3594+4	6BBF  1F      	        RRA
 787: 3598+4	6BC0  1F      	        RRA
 788: 3602+10+7	6BC1  DC196C  	        CALL    C,LEFARW
 789: 3612+4	6BC4  1F      	        RRA
 790: 3616+10+7	6BC5  DC1F6C  	        CALL    C,RGTARW
 791: 3626+13	6BC8  3A0238  	        LD      A,(NOKEY)
 792: 3639+4	6BCB  B7      	        OR      A               ;To test for 'o' - move.
 793: 3643+7+5	6BCC  28E5    	        JR      Z,PLAYIN
 794:				        
 795: 3650+17	6BCE  CD486B  	        CALL    CLRLIN
 796: 3667+13	6BD1  3A1168  	        LD      A,(BRDPOS)      ;Get position
 797: 3680+4	6BD4  6F      	        LD      L,A
 798: 3684+7	6BD5  2600    	        LD      H,0
 799: 3691+10	6BD7  110060  	        LD      DE,BOARD
 800: 3701+11	6BDA  19      	        ADD     HL,DE
 801: 3712+7	6BDB  7E      	        LD      A,(HL)          ;Get token
 802: 3719+4	6BDC  B7      	        OR      A               ;Test for no move yet
 803: 3723+7+5	6BDD  2816    	        JR      Z,POSIT         ;If no move, posit move.
 804:				        
 805: 3730+7	6BDF  2678    	BADMOV: LD      H,78H           ;78H refs grafix 'bad'
 806: 3737+11	6BE1  E5      	        PUSH    HL
 807: 3748+17	6BE2  CDE569  	        CALL    LOCFIL          ;Fill loc w/ 'badbadbad'
 808: 3765+7	6BE5  0600    	        LD      B,0
 809: 3772+17	6BE7  CD746A  	        CALL    PAUSE
 810: 3789+17	6BEA  CD746A  	        CALL    PAUSE
 811: 3806+10	6BED  E1      	        POP     HL
 812: 3816+7	6BEE  2679    	        LD      H,79H           ;79H refs grafix cursor
 813: 3823+17	6BF0  CDE569  	        CALL    LOCFIL          ;Put cursor
 814: 3840+12	6BF3  18BE    	        JR      PLAYIN          ;Reenter move key scan
 815:				        
 816: 3852+10	6BF5  3601    	POSIT:  LD      (HL),01H        ;Player token
 817: 3862+7	6BF7  2600    	        LD      H,0
 818: 3869+7	6BF9  0628    	        LD      B,40
 819: 3876+17	6BFB  CD996A  	        CALL    FLSHMV          ;Flash move on screen
 820: 3893+17	6BFE  CDA86C  	        CALL    ANLYZE
 821: 3910+4	6C01  B7      	        OR      A
 822: 3914+10	6C02  CA676C  	        JP      Z,XFIRST+6      ;All well/machine next  
 823: 3924+7	6C05  FE01    	        CP      1               ;Player win?
 824: 3931+7+5	6C07  2807    	        JR      Z,OWIN
 825: 3938+14	6C09  DD21FB66	CATWIN: LD      IX,CNFIG5       ;'cats'
 826: 3952+10	6C0D  C38C6C  	        JP      XWIN+7          ;Fill screen/disp. cycle
 827:				        
 828: 3962+17	6C10  CD7D6A  	OWIN:   CALL    FLSHRW          ;Flash row
 829: 3979+14	6C13  DD217B66	        LD      IX,CNFIG3       ;'you win'
 830: 3993+12	6C17  1873    	        JR      XWIN+7
 831:				        
 832: 4005+7	6C19  06FF    	LEFARW: LD      B,0FFH          ;0FF0 = -1
 833: 4012+17	6C1B  CD256C  	        CALL    NEWPOS
 834: 4029+10	6C1E  C9      	        RET
 835:				        
 836: 4039+7	6C1F  0601    	RGTARW: LD      B,1
 837: 4046+17	6C21  CD256C  	        CALL    NEWPOS
 838: 4063+10	6C24  C9      	        RET
 839:				        
 840: 4073+11	6C25  C5      	NEWPOS: PUSH    BC              ;Save move value in 'b'
 841: 4084+13	6C26  3A1168  	        LD      A,(BRDPOS)      ;Get current board posn
 842: 4097+11	6C29  F5      	        PUSH    AF              ;Save it.
 843: 4108+4	6C2A  6F      	        LD      L,A
 844: 4112+7	6C2B  2600    	        LD      H,0
 845: 4119+17	6C2D  CDC56A  	        CALL    PUTTOK          ;Reinstate token grafix
 846: 4136+10	6C30  F1      	        POP     AF              ;Get brdpos
 847: 4146+17	6C31  CD486C  	        CALL    POSFIX          ;Fix for move math
 848: 4163+10	6C34  C1      	        POP     BC              ;'B' <= -16,16,-1 or 1
 849: 4173+4	6C35  80      	        ADD     A,B
 850: 4177+17	6C36  CD486C  	        CALL    POSFIX          ;Fix it back again
 851: 4194+13	6C39  321168  	        LD      (BRDPOS),A      ;Update brdpos
 852: 4207+4	6C3C  6F      	        LD      L,A             ;New board location
 853: 4211+7	6C3D  2679    	        LD      H,79H           ;79H is cursor grafix
 854: 4218+17	6C3F  CDE569  	        CALL    LOCFIL
 855: 4235+7	6C42  0628    	        LD      B,28H   ;Delay factor
 856: 4242+17	6C44  CD746A  	        CALL    PAUSE
 857: 4259+10	6C47  C9      	        RET
 858:				        
 859: 4269+7	6C48  E63F    	POSFIX: AND     3FH     ;Strip off 6,7 bits
 860: 4276+4	6C4A  47      	        LD      B,A
 861: 4280+7	6C4B  E603    	        AND     03H
 862: 4287+4	6C4D  4F      	        LD      C,A
 863: 4291+4	6C4E  78      	        LD      A,B
 864: 4295+7	6C4F  E63C    	        AND     3CH
 865: 4302+4	6C51  47      	        LD      B,A
 866: 4306+7	6C52  E630    	        AND     30H
 867: 4313+4	6C54  57      	        LD      D,A
 868: 4317+4	6C55  78      	        LD      A,B
 869: 4321+7	6C56  E60C    	        AND     0CH
 870: 4328+4	6C58  07      	        RLCA
 871: 4332+4	6C59  07      	        RLCA
 872: 4336+4	6C5A  47      	        LD      B,A
 873: 4340+4	6C5B  7A      	        LD      A,D
 874: 4344+4	6C5C  0F      	        RRCA
 875: 4348+4	6C5D  0F      	        RRCA
 876: 4352+4	6C5E  80      	        ADD     A,B
 877: 4356+4	6C5F  81      	        ADD     A,C
 878: 4360+10	6C60  C9      	        RET
 879:				        
 880: 4370+17	6C61  CD486B  	XFIRST: CALL    CLRLIN
 881: 4387+17	6C64  CDA86C  	        CALL    ANLYZE
 882: 4404+10	6C67  110060  	        LD      DE,BOARD
 883: 4414+11	6C6A  19      	        ADD     HL,DE
 884: 4425+10	6C6B  3610    	        LD      (HL),10H        ;Posit machine move
 885: 4435+7	6C6D  2600    	        LD      H,0
 886: 4442+7	6C6F  061E    	        LD      B,30
 887: 4449+17	6C71  CD996A  	        CALL    FLSHMV          ;Flash it
 888: 4466+17	6C74  CDA86C  	        CALL    ANLYZE
 889: 4483+4	6C77  B7      	        OR      A               ;O. K. ?
 890: 4487+10	6C78  CA9A6B  	        JP      Z,OFIRST
 891: 4497+7	6C7B  FE01    	        CP      1               ;Win?
 892: 4504+7+5	6C7D  2806    	        JR      Z,XWIN
 893:				        
 894: 4511+14	6C7F  DD21FB66	CATWN2: LD      IX,CNFIG5       ;'cats'
 895: 4525+12	6C83  1807    	        JR      XWIN+7
 896:				        
 897: 4537+17	6C85  CD7D6A  	XWIN:   CALL    FLSHRW
 898: 4554+14	6C88  DD21BB66	        LD      IX,CNFIG4       ;'I win'
 899: 4568+17	6C8C  CDA269  	        CALL    SCRFIL
 900: 4585+7	6C8F  0600    	        LD      B,0
 901: 4592+17	6C91  CD746A  	        CALL    PAUSE
 902: 4609+17	6C94  CD746A  	        CALL    PAUSE
 903: 4626+10	6C97  C31D69  	        JP      CYCLE
 904:				        
 905:				        
 906:				        
 907:				        
 908:				;       THIS SEGMENT CLEARS THE BOARD FOR A NEW GAME --
 909:				        
 910: 4636+10	6C9A  210060  	NEWBRD: LD      HL,BOARD
 911: 4646+10	6C9D  3600    	        LD      (HL),0
 912: 4656+11	6C9F  E5      	        PUSH    HL
 913: 4667+10	6CA0  D1      	        POP     DE
 914: 4677+6	6CA1  13      	        INC     DE
 915: 4683+10	6CA2  013F00  	        LD      BC,63           ;Set up for zero-out
 916: 4693+16+5	6CA5  EDB0    	        LDIR            ;Board cleared!
 917: 4709+10	6CA7  C9      	        RET                     ;Back to basic ====>
 918:				        
 919:				        
 920:				;       THIS IS THE MAIN FUNCTION OF THIS WHOLE THING;
 921:				;               TO ANALYZE THE BOARD AND DETERMINE THE
 922:				;                       BEST COUNTER-MOVE.
 923:				        
 924:				        
 925: 4719+14	6CA8  FD217B67	ANLYZE: LD      IY,SCORES
 926: 4733+14	6CAC  DD21BB67	        LD      IX,SRTREF
 927: 4747+7	6CB0  0640    	        LD      B,64            ;Loop 64 times
 928: 4754+4	6CB2  AF      	        XOR     A
 929:				        
 930: 4758+13	6CB3  32BB6C  	LDLOOP: LD      (IYCD0+2),A
 931: 4771+13	6CB6  32BF6C  	        LD      (IXCD0+2),A
 932: 4784+19	6CB9  FD360000	IYCD0:  LD      (IY+0),0        ;Ld scores w/ zeros
 933: 4803+19	6CBD  DD7700  	IXCD0:  LD      (IX+0),A        ;Ld N into (IX+N)
 934: 4822+4	6CC0  3C      	        INC     A
 935: 4826+8+5	6CC1  10F0    	        DJNZ    LDLOOP
 936:				        
 937: 4834+14	6CC3  DD210060	        LD      IX,BOARD
 938: 4848+7	6CC7  064C    	        LD      B,76            ;Row reference loop
 939: 4855+10	6CC9  214160  	        LD      HL,REFTBL
 940:				        
 941: 4865+11	6CCC  C5      	ROWTST: PUSH    BC
 942: 4876+11	6CCD  E5      	        PUSH    HL
 943: 4887+7	6CCE  0604    	        LD      B,4             ;Number across row
 944: 4894+7	6CD0  1600    	        LD      D,0             ;Initialize move accum.
 945:				        
 946: 4901+7	6CD2  7E      	ROWADD: LD      A,(HL)          ;Get ref
 947: 4908+13	6CD3  32D86C  	        LD      (IXCD1+2),A     ;Load into code
 948: 4921+19	6CD6  DD7E00  	IXCD1:  LD      A,(IX+0)        ;A <= MOVE (01H OR 10H)
 949: 4940+4	6CD9  82      	        ADD     A,D
 950: 4944+4	6CDA  57      	        LD      D,A             ;Acc into D
 951: 4948+6	6CDB  23      	        INC     HL              ;For next ref
 952: 4954+8+5	6CDC  10F4    	        DJNZ    ROWADD
 953:				        
 954: 4962+4	6CDE  7A      	        LD      A,D
 955: 4966+7	6CDF  E60F    	        AND     0FH             ;Test for machine move
 956: 4973+7+5	6CE1  2807    	        JR      Z,SFTGRD        ;'shift then grade'
 957: 4980+4	6CE3  7A      	        LD      A,D             ;No?  then ;
 958: 4984+7	6CE4  E6F0    	        AND     0F0H            ;Test for human move
 959: 4991+7+5	6CE6  280A    	        JR      Z,GRD           ;'grade' no shift needed
 960: 4998+12	6CE8  183A    	        JR      NXTROW          ;If mixed, 'next row 1'
 961:				        
 962: 5010+8	6CEA  CB3A    	SFTGRD: SRL     D
 963: 5018+8	6CEC  CB3A    	        SRL     D
 964: 5026+8	6CEE  CB3A    	        SRL     D
 965: 5034+8	6CF0  CB3A    	        SRL     D               ;Right justify
 966:				        
 967: 5042+4	6CF2  7A      	GRD:    LD      A,D
 968: 5046+7	6CF3  FE04    	        CP      4               ;But first, test for win
 969: 5053+10	6CF5  CAA36D  	        JP      Z,WIN           ;Jp to win if won
 970:				        
 971: 5063+15	6CF8  FDE5    	        PUSH    IY
 972: 5078+20	6CFA  FD2A0F68	        LD      IY,(EXPTBX)
 973: 5098+13	6CFE  32036D  	        LD      (IYCD50+2),A
 974: 5111+19	6D01  FD5600  	IYCD50: LD      D,(IY+0)
 975: 5130+14	6D04  FDE1    	        POP     IY
 976:				        
 977: 5144+10	6D06  E1      	        POP     HL              ;Get beg of ref row
 978: 5154+11	6D07  E5      	        PUSH    HL              ;Stuff it back
 979: 5165+7	6D08  0604    	        LD      B,4
 980:				        
 981: 5172+7	6D0A  7E      	FOURZR: LD      A,(HL)          ;Get that ref
 982: 5179+13	6D0B  32166D  	        LD      (IXCD2+2),A     ;Load code w/ ref
 983: 5192+13	6D0E  321C6D  	        LD      (IYCD10+2),A
 984: 5205+13	6D11  32206D  	        LD      (IYCD11+2),A
 985: 5218+19	6D14  DD7E00  	IXCD2:  LD      A,(IX+0)        ;A <= move
 986: 5237+4	6D17  B7      	        OR      A               ;Test for no move yet
 987: 5241+7+5	6D18  2007    	        JR      NZ,NXT4ZR       ;If not 0, next ref
 988: 5248+19	6D1A  FD7E00  	IYCD10: LD      A,(IY+0)
 989: 5267+4	6D1D  82      	        ADD     A,D
 990: 5271+19	6D1E  FD7700  	IYCD11: LD      (IY+0),A
 991:				        
 992: 5290+6	6D21  23      	NXT4ZR: INC     HL              ;HL <= next ref
 993: 5296+8+5	6D22  10E6    	        DJNZ    FOURZR
 994:				        
 995: 5304+10	6D24  E1      	NXTROW: POP     HL
 996: 5314+6	6D25  23      	        INC     HL
 997: 5320+6	6D26  23      	        INC     HL
 998: 5326+6	6D27  23      	        INC     HL
 999: 5332+6	6D28  23      	        INC     HL
1000: 5338+10	6D29  C1      	        POP     BC              ;Big ref count (76)
1001: 5348+8+5	6D2A  10A0    	        DJNZ    ROWTST
1002:				        
1003:				        
1004:				;       NOW THAT WE'VE GRADED THE OPEN MOVE SPACES, WE
1005:				;       HAVE TO SORT THESE FIGURES TO FIND THE MOST
1006:				;       CRITICAL MOVE OPPORTUNITIES.  WE'LL ALSO SORT THE
1007:				;       POINTERS SO WE CAN KEEP TABS ON WHICH GRADINGS GO
1008:				;       WITH WHICH BOARD LOCATIONS.
1009:				        
1010:				        
1011: 5356+14	6D2C  DD21BB67	SORT:   LD      IX,SRTREF
1012: 5370+7	6D30  063F    	        LD      B,63
1013: 5377+7	6D32  1600    	        LD      D,0
1014:				        
1015:				        
1016: 5384+4	6D34  48      	SRT1ST: LD      C,B
1017: 5388+4	6D35  0D      	        DEC     C
1018: 5392+7+5	6D36  2001    	        JR      NZ,CONT
1019: 5399+4	6D38  0C      	        INC     C
1020:				        
1021: 5403+4	6D39  5A      	CONT:   LD      E,D
1022: 5407+4	6D3A  1C      	        INC     E
1023:				        
1024: 5411+4	6D3B  7A      	        LD      A,D
1025: 5415+13	6D3C  324D6D  	        LD      (IYCD20+2),A
1026: 5428+13	6D3F  326C6D  	        LD      (IYCD21+2),A
1027: 5441+13	6D42  32AE6D  	        LD      (IYCD22+2),A
1028:				        
1029: 5454+13	6D45  32B76D  	        LD      (IXCD21+2),A
1030: 5467+13	6D48  32BD6D  	        LD      (IXCD22+2),A
1031:				        
1032: 5480+19	6D4B  FD7E00  	IYCD20: LD      A,(IY+0)        ;Ld up 1stloop comparator
1033:				        
1034: 5499+11	6D4E  F5      	SRT2ND: PUSH    AF
1035: 5510+4	6D4F  7B      	        LD      A,E
1036:				        
1037: 5514+13	6D50  32626D  	        LD      (IYCD25+2),A
1038: 5527+13	6D53  32AB6D  	        LD      (IYCD26+2),A
1039: 5540+13	6D56  32B16D  	        LD      (IYCD27+2),A
1040:				        
1041: 5553+13	6D59  32B46D  	        LD      (IXCD26+2),A
1042: 5566+13	6D5C  32BA6D  	        LD      (IXCD27+2),A
1043:				        
1044: 5579+10	6D5F  F1      	        POP     AF
1045:				        
1046: 5589+19	6D60  FDBE00  	IYCD25: CP      (IY+0)
1047:				        
1048: 5608+10+7	6D63  DCA86D  	        CALL    C,SWITCH
1049:				        
1050: 5618+4	6D66  1C      	        INC     E
1051: 5622+4	6D67  0D      	        DEC     C
1052: 5626+7+5	6D68  20E4    	        JR      NZ,SRT2ND
1053:				        
1054: 5633+19	6D6A  FD7700  	IYCD21: LD      (IY+0),A
1055: 5652+4	6D6D  14      	        INC     D
1056: 5656+8+5	6D6E  10C4    	        DJNZ    SRT1ST
1057:				        
1058:				        
1059:				        
1060:				;       NOW IN THIS SECTION WE ASCERTAIN THE NUMBER OF
1061:				;       IDENTICALLY 'WEIGHTED' HIGH SCORES AT THE
1062:				;       TOP OF OUR LIST.  WE'LL BE CHOOSING FROM ONE OF
1063:				;       THEM.
1064:				        
1065:				        
1066: 5664+19	6D70  FD7E00  	ADJSCH: LD      A,(IY+0)
1067: 5683+4	6D73  B7      	        OR      A
1068: 5687+7+5	6D74  2003    	        JR      NZ,ADJSET
1069: 5694+7	6D76  3E02    	        LD      A,2             ;2 means 'cats'
1070: 5701+10	6D78  C9      	        RET
1071:				        
1072: 5711+7	6D79  063F    	ADJSET: LD      B,63
1073: 5718+7	6D7B  1E01    	        LD      E,1
1074:				        
1075: 5725+4	6D7D  53      	ADJLOP: LD      D,E
1076: 5729+4	6D7E  15      	        DEC     D
1077: 5733+4	6D7F  7A      	        LD      A,D
1078: 5737+13	6D80  32896D  	        LD      (IYCD30+2),A
1079: 5750+4	6D83  7B      	        LD      A,E
1080: 5754+13	6D84  328C6D  	        LD      (IYCD31+2),A
1081: 5767+19	6D87  FD7E00  	IYCD30: LD      A,(IY+0)
1082: 5786+19	6D8A  FDBE00  	IYCD31: CP      (IY+0)
1083: 5805+7+5	6D8D  2003    	        JR      NZ,SLCTMV
1084: 5812+4	6D8F  1C      	        INC     E
1085: 5816+8+5	6D90  10EB    	        DJNZ    ADJLOP
1086:				        
1087:				        
1088:				        
1089:				        
1090:				        
1091:				;       NOW, IN THIS SECTION, WE SELECT THE MOVE.  THE
1092:				;       NUMBER OF MOVES OF EQUAL AND MOST IMPORTANT
1093:				;       VALIDITY, HAS BEEN DEPOSITED IN REGISTER 'C'.
1094:				        
1095:				        
1096: 5824+17	6D92  CDBF6D  	SLCTMV: CALL    RANDOM
1097:				        
1098: 5841+4	6D95  9B      	DIVLOP: SBC     A,E
1099: 5845+7+5	6D96  30FD    	        JR      NC,DIVLOP
1100: 5852+4	6D98  83      	        ADD     A,E
1101: 5856+13	6D99  329E6D  	        LD      (IXCD40+2),A
1102: 5869+19	6D9C  DD6E00  	IXCD40: LD      L,(IX+0)
1103: 5888+4	6D9F  AF      	        XOR     A               ;A = 0 means no win
1104: 5892+7	6DA0  2600    	        LD      H,0
1105: 5899+10	6DA2  C9      	        RET
1106:				        
1107:				        
1108: 5909+10	6DA3  D1      	WIN:    POP     DE
1109: 5919+10	6DA4  C1      	        POP     BC              ;Clean off stack
1110: 5929+7	6DA5  3E01    	        LD      A,1             ;A = 1 means win
1111: 5936+10	6DA7  C9      	        RET
1112:				        
1113:				        
1114: 5946+4	6DA8  6F      	SWITCH: LD      L,A
1115:				        
1116: 5950+19	6DA9  FD7E00  	IYCD26: LD      A,(IY+0)
1117: 5969+19	6DAC  FD7700  	IYCD22: LD      (IY+0),A
1118: 5988+19	6DAF  FD7500  	IYCD27: LD      (IY+0),L
1119:				        
1120: 6007+19	6DB2  DD6E00  	IXCD26: LD      L,(IX+0)
1121: 6026+19	6DB5  DD6600  	IXCD21: LD      H,(IX+0)
1122: 6045+19	6DB8  DD7400  	IXCD27: LD      (IX+0),H
1123: 6064+19	6DBB  DD7500  	IXCD22: LD      (IX+0),L
1124:				        
1125: 6083+10	6DBE  C9      	        RET
1126:				        
1127:				;       Thank you, thank you, thank you, Bruce Hanson
1128:				;               for this charming routine.
1129:				        
1130: 6093+11	6DBF  E5      	RANDOM: PUSH    HL              ;Save it
1131: 6104+16	6DC0  2A1268  	        LD      HL,(RNDPNT)     ;Get old location
1132: 6120+6	6DC3  23      	        INC     HL
1133: 6126+4	6DC4  7C      	        LD      A,H
1134: 6130+7	6DC5  FE30    	        CP      30H             ;Out of ROM?
1135: 6137+7+5	6DC7  3802    	        JR      C,RAN10         ;Nope
1136: 6144+7	6DC9  2600    	        LD      H,0             ;Yep
1137: 6151+16	6DCB  221268  	RAN10:  LD      (RNDPNT),HL     ;Renew RNDPNT
1138: 6167+7	6DCE  7E      	        LD      A,(HL)          ;Get "Random" number
1139: 6174+10	6DCF  E1      	        POP     HL              ;Get original HL
1140:				        
1141: 6184+10	6DD0  C9      	        RET
1142:				        
1143:     -	6912          	        END     START



Statistics:

     4	passes
     0	jr promotions
   125	symbols
  3344	bytes



Symbol Table:

ADJLOP          6D7D      28029
ADJSCH          6D70      28016
ADJSET          6D79      28025
ANLYZE          6CA8      27816
ARWKEY         =3840      14400
BADMOV          6BDF      27615
BLNKTK          6AD9      27353
BOARD           6000      24576
BRDPOS          6811      26641
CATWIN          6C09      27657
CATWN2          6C7F      27775
CLEAR          = 1C9      457
CLRLIN          6B48      27464
CNFIG0          65BB      26043
CNFIG1          65FB      26107
CNFIG2          663B      26171
CNFIG3          667B      26235
CNFIG4          66BB      26299
CNFIG5          66FB      26363
CNFIG6          673B      26427
CNTFIL          6ADB      27355
COLCON          6A09      27145
CONT            6D39      27961
CYCLE           691D      26909
DIVLOP          6D95      28053
EXPTBL          67FB      26619
EXPTBX          680F      26639
FIGMAT          6171      24945
FLIP            6B69      27497
FLMVLP          6A9A      27290
FLRWL1          6A80      27264
FLRWL2          6A84      27268
FLSHMV          6A99      27289
FLSHRW          6A7D      27261
FOURZR          6D0A      27914
GAME            6ADF      27359
GETCHO          6B38      27448
GETFLP          6B23      27427
GETNUM          6AFE      27390
GOTNUM          6B0B      27403
GRD             6CF2      27890
IXCD0           6CBD      27837
IXCD1           6CD6      27862
IXCD2           6D14      27924
IXCD21          6DB5      28085
IXCD22          6DBB      28091
IXCD26          6DB2      28082
IXCD27          6DB8      28088
IXCD40          6D9C      28060
IXCD60          69C9      27081
IYCD0           6CB9      27833
IYCD10          6D1A      27930
IYCD11          6D1E      27934
IYCD20          6D4B      27979
IYCD21          6D6A      28010
IYCD22          6DAC      28076
IYCD25          6D60      28000
IYCD26          6DA9      28073
IYCD27          6DAF      28079
IYCD30          6D87      28039
IYCD31          6D8A      28042
IYCD50          6D01      27905
IYCD60          69BA      27066
IYCD61          69C0      27072
LDLOOP          6CB3      27827
LEFARW          6C19      27673
LKAGIN          69AE      27054
LOCFIL          69E5      27109
LOCZER         =3C45      15429
MDSPLY          6B56      27478
MESS1           6814      26644
MESS2           6848      26696
MESS3           687C      26748
MESS4           6896      26774
MESS5           68AC      26796
MESS6           68C1      26817
MESS7           68DA      26842
MESSLP          6B62      27490
NEWBRD          6C9A      27802
NEWPOS          6C25      27685
NOKEY          =3802      14338
NUMKEY         =3810      14352
NXBYT1          6B04      27396
NXT4ZR          6D21      27937
NXTLOC          69A7      27047
NXTROW          6D24      27940
O1STMS          6B86      27526
OFIRST          6B9A      27546
OHTK            6AD5      27349
OWIN            6C10      27664
PANEL           69E9      27113
PAUSE           6A74      27252
PLAYIN          6BB3      27571
PNLOOP          69F5      27125
POSFIX          6C48      27720
POSIT           6BF5      27637
PSLOP2          6A77      27255
PUTTOK          6AC5      27333
RAN10           6DCB      28107
RANDOM          6DBF      28095
REFTBL          6041      24641
RGTARW          6C1F      27679
RNDPNT          6812      26642
ROW             6A00      27136
ROWADD          6CD2      27858
ROWCON          69F2      27122
ROWLOP          6A0F      27151
ROWTST          6CCC      27852
SCORES          677B      26491
SCRFIL          69A2      27042
SFTGRD          6CEA      27882
SIMLTE          6970      26992
SIMOUT          6995      27029
SIMTOK          697B      27003
SLCTMV          6D92      28050
SORT            6D2C      27948
SRT1ST          6D34      27956
SRT2ND          6D4E      27982
SRTREF          67BB      26555
START           6912      26898
SWITCH          6DA8      28072
WIN             6DA3      28067
XFIRST          6C61      27745
XWIN            6C85      27781
YXKEY          =3808      14344
